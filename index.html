<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>鸿渚资源分享站</title>
    <meta name="description" content="基于Markdown的静态资源分享站 · 支持网页推荐、软件下载、文件分享、技术文章">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        :root {
            /* 主色调 */
            --primary: #3b82f6;
            --primary-dark: #2563eb;
            --secondary: #64748b;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            
            /* 背景与文字 */
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-card: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --border-color: #e2e8f0;
            
            /* 阴影 */
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            
            /* 圆角 */
            --radius-sm: 0.375rem;
            --radius: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-full: 9999px;
            
            /* 间距 */
            --space-xs: 0.5rem;
            --space-sm: 0.75rem;
            --space: 1rem;
            --space-md: 1.25rem;
            --space-lg: 1.5rem;
            --space-xl: 2rem;
        }

        /* 深色模式 */
        .dark-mode {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-card: #1e293b;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border-color: #334155;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.5;
            transition: background-color 0.3s, color 0.3s;
            min-height: 100vh;
        }

        /* 容器 */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 var(--space);
        }

        /* 头部 */
        header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: var(--space-xl) 0;
            margin-bottom: var(--space-xl);
        }

        .header-content {
            text-align: center;
        }

        .site-title {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: var(--space-sm);
        }

        .site-subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: var(--space-xl);
        }

        /* 统计卡片 */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space);
            margin-bottom: var(--space-xl);
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: var(--radius);
            padding: var(--space-lg);
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: var(--space-xs);
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* 主体内容 */
        .content-wrapper {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: var(--space-xl);
            padding-bottom: var(--space-xl);
        }

        /* 侧边栏 */
        .sidebar {
            position: sticky;
            top: var(--space);
            height: fit-content;
        }

        .filter-section {
            background: var(--bg-card);
            border-radius: var(--radius);
            padding: var(--space);
            box-shadow: var(--shadow);
            margin-bottom: var(--space);
            border: 1px solid var(--border-color);
        }

        .filter-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: var(--space);
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }

        .filter-title i {
            color: var(--primary);
        }

        .filter-options {
            display: flex;
            flex-direction: column;
            gap: var(--space-xs);
        }

        .filter-btn {
            padding: var(--space-sm) var(--space);
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
            font-size: 0.9rem;
        }

        .filter-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .filter-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .search-box {
            position: relative;
            margin-bottom: var(--space);
        }

        .search-input {
            width: 100%;
            padding: var(--space-sm) var(--space);
            padding-left: 2.5rem;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            color: var(--text-primary);
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .search-icon {
            position: absolute;
            left: var(--space);
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
        }

        /* 主题切换 */
        .theme-toggle {
            width: 100%;
            padding: var(--space-sm);
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-xs);
            font-size: 0.9rem;
        }

        .theme-toggle:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        /* 主内容区 */
        .main-content {
            min-height: 400px;
        }

        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space);
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .section-subtitle {
            font-size: 0.95rem;
            color: var(--text-secondary);
        }

        /* 资源卡片网格 */
        .resources-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: var(--space);
        }

        .resource-card {
            background: var(--bg-card);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: all 0.3s;
            border: 1px solid var(--border-color);
        }

        .resource-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-md);
            border-color: var(--primary);
        }

        .resource-header {
            padding: var(--space);
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
        }

        .resource-type {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            background: var(--primary);
            color: white;
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            font-weight: 500;
        }

        .resource-body {
            padding: var(--space);
        }

        .resource-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: var(--space-xs);
            color: var(--text-primary);
        }

        .resource-description {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: var(--space);
            line-height: 1.4;
        }

        .resource-meta {
            display: flex;
            gap: var(--space);
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .resource-footer {
            padding: var(--space);
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .resource-actions {
            display: flex;
            gap: var(--space-xs);
        }

        .action-btn {
            padding: 0.375rem 0.75rem;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .action-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* 加载状态 */
        .loading {
            text-align: center;
            padding: var(--space-xl);
            color: var(--text-secondary);
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border-color);
            border-top-color: var(--primary);
            border-radius: 50%;
            margin: 0 auto var(--space);
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .error-message {
            text-align: center;
            padding: var(--space-xl);
            color: var(--danger);
        }

        .error-message i {
            font-size: 3rem;
            margin-bottom: var(--space);
        }

        /* 模态框 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            overflow-y: auto;
        }

        .modal-content {
            background: var(--bg-card);
            border-radius: var(--radius);
            max-width: 800px;
            margin: var(--space) auto;
            box-shadow: var(--shadow-md);
        }

        .modal-header {
            padding: var(--space);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 0;
            width: 2rem;
            height: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-sm);
        }

        .modal-close:hover {
            background: var(--bg-secondary);
        }

        .modal-body {
            padding: var(--space);
            max-height: 70vh;
            overflow-y: auto;
        }

        /* 响应式设计 */
        @media (max-width: 768px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                position: static;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .resources-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- 头部 -->
    <header>
        <div class="container">
            <div class="header-content">
                <h1 class="site-title">鸿渚资源分享站</h1>
                <p class="site-subtitle">基于Markdown的静态资源分享站 · 支持网页推荐、软件下载、文件分享、技术文章</p>
                
                <!-- 统计卡片 -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="webCount">0</div>
                        <div class="stat-label">网页分享</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="softwareCount">0</div>
                        <div class="stat-label">软件分享</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="fileCount">0</div>
                        <div class="stat-label">文件分享</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="articleCount">0</div>
                        <div class="stat-label">文章分享</div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- 主体内容 -->
    <main class="container">
        <div class="content-wrapper">
            <!-- 侧边栏 -->
            <aside class="sidebar">
                <!-- 搜索框 -->
                <div class="filter-section">
                    <div class="search-box">
                        <i class="fas fa-search search-icon"></i>
                        <input type="text" class="search-input" id="searchInput" placeholder="搜索资源...">
                    </div>
                </div>

                <!-- 分类筛选 -->
                <div class="filter-section">
                    <h3 class="filter-title"><i class="fas fa-folder"></i>分类</h3>
                    <div class="filter-options" id="categoryFilters">
                        <!-- 分类按钮动态生成 -->
                    </div>
                </div>

                <!-- 类型筛选 -->
                <div class="filter-section">
                    <h3 class="filter-title"><i class="fas fa-tags"></i>类型</h3>
                    <div class="filter-options" id="typeFilters">
                        <!-- 类型按钮动态生成 -->
                    </div>
                </div>

                <!-- 主题切换 -->
                <button class="theme-toggle" id="themeToggle">
                    <i class="fas fa-moon"></i>
                    <span>深色模式</span>
                </button>
            </aside>

            <!-- 主内容区 -->
            <div class="main-content">
                <div class="content-header">
                    <div>
                        <h2 class="section-title" id="currentFilter">全部资源</h2>
                        <p class="section-subtitle" id="resourceCount">共 0 个资源</p>
                    </div>
                </div>

                <!-- 资源卡片容器 -->
                <div class="resources-grid" id="resourcesGrid">
                    <!-- 资源卡片动态生成 -->
                </div>

                <!-- 加载状态 -->
                <div class="loading" id="loadingIndicator">
                    <div class="loading-spinner"></div>
                    <p>加载资源中...</p>
                </div>

                <!-- 错误信息 -->
                <div class="error-message" id="errorMessage" style="display: none;">
                    <i class="fas fa-exclamation-triangle"></i>
                    <h3>加载失败</h3>
                    <p>无法加载资源数据，请检查控制台或网络连接。</p>
                </div>
            </div>
        </div>
    </main>

    <!-- 详情模态框 -->
    <div class="modal" id="resourceModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">资源详情</h2>
                <button class="modal-close" id="modalClose">&times;</button>
            </div>
            <div class="modal-body" id="modalContent">
                <!-- 模态框内容动态生成 -->
            </div>
        </div>
    </div>

    <script>
        class ResourceManager {
            constructor() {
                this.resources = [];
                this.filteredResources = [];
                this.categories = new Set();
                this.types = new Set(['web', 'software', 'file', 'article']);
                this.currentCategory = '';
                this.currentType = '';
                this.searchTerm = '';
            }

            async loadResources() {
                try {
                    // 显示加载状态
                    this.showLoading();
                    
                    // 加载 data-index.json
                    const response = await fetch('data-index.json');
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const indexData = await response.json();
                    
                    this.resources = [];
                    
                    // 加载卡片资源
                    if (indexData.cards && Array.isArray(indexData.cards)) {
                        await this.loadCardResources(indexData.cards);
                    }
                    
                    // 加载文章资源
                    if (indexData.articles && Array.isArray(indexData.articles)) {
                        await this.loadArticleResources(indexData.articles);
                    }
                    
                    // 加载文件资源
                    if (indexData.files && Array.isArray(indexData.files)) {
                        await this.loadFileResources(indexData.files);
                    }
                    
                    // 初始化筛选结果
                    this.filteredResources = [...this.resources];
                    
                    // 更新UI
                    this.updateStats();
                    this.renderCategories();
                    this.renderTypes();
                    this.renderResources();
                    
                    // 隐藏加载状态
                    this.hideLoading();
                    
                } catch (error) {
                    console.error('加载资源失败:', error);
                    this.showError();
                }
            }

            async loadCardResources(cardPaths) {
                for (const path of cardPaths) {
                    try {
                        const response = await fetch(path);
                        if (!response.ok) continue;
                        
                        const content = await response.text();
                        const parsed = this.parseMarkdown(content);
                        
                        if (parsed.frontMatter) {
                            const resource = {
                                id: `card_${Date.now()}_${Math.random()}`,
                                title: parsed.frontMatter.title || '未命名卡片',
                                description: parsed.frontMatter.description || '',
                                category: parsed.frontMatter.category || '未分类',
                                type: parsed.frontMatter.type || 'web',
                                url: parsed.frontMatter.url || '#',
                                icon: this.getTypeIcon(parsed.frontMatter.type || 'web'),
                                tags: parsed.frontMatter.tags ? parsed.frontMatter.tags.split(',').map(t => t.trim()) : [],
                                content: parsed.content,
                                filePath: path,
                                date: parsed.frontMatter.date || new Date().toISOString().split('T')[0]
                            };
                            
                            this.resources.push(resource);
                            this.categories.add(resource.category);
                        }
                    } catch (error) {
                        console.warn(`加载卡片失败: ${path}`, error);
                    }
                }
            }

            async loadArticleResources(articlePaths) {
                for (const path of articlePaths) {
                    try {
                        const response = await fetch(path);
                        if (!response.ok) continue;
                        
                        const content = await response.text();
                        const parsed = this.parseMarkdown(content);
                        
                        if (parsed.frontMatter) {
                            const resource = {
                                id: `article_${Date.now()}_${Math.random()}`,
                                title: parsed.frontMatter.title || '未命名文章',
                                description: parsed.frontMatter.description || '',
                                category: parsed.frontMatter.category || '文章',
                                type: 'article',
                                url: '#',
                                icon: 'fas fa-newspaper',
                                tags: parsed.frontMatter.tags ? parsed.frontMatter.tags.split(',').map(t => t.trim()) : [],
                                content: parsed.content,
                                filePath: path,
                                date: parsed.frontMatter.date || new Date().toISOString().split('T')[0]
                            };
                            
                            this.resources.push(resource);
                            this.categories.add(resource.category);
                        }
                    } catch (error) {
                        console.warn(`加载文章失败: ${path}`, error);
                    }
                }
            }

            async loadFileResources(filePaths) {
                for (const path of filePaths) {
                    try {
                        const response = await fetch(path);
                        if (!response.ok) continue;
                        
                        const content = await response.text();
                        const parsed = this.parseMarkdown(content);
                        
                        if (parsed.frontMatter) {
                            const resource = {
                                id: `file_${Date.now()}_${Math.random()}`,
                                title: parsed.frontMatter.title || '未命名文件',
                                description: parsed.frontMatter.description || '',
                                category: parsed.frontMatter.category || '文件',
                                type: 'file',
                                url: parsed.frontMatter.downloadUrl || '#',
                                icon: 'fas fa-download',
                                tags: parsed.frontMatter.tags ? parsed.frontMatter.tags.split(',').map(t => t.trim()) : [],
                                content: parsed.content,
                                filePath: path,
                                date: parsed.frontMatter.date || new Date().toISOString().split('T')[0]
                            };
                            
                            this.resources.push(resource);
                            this.categories.add(resource.category);
                        }
                    } catch (error) {
                        console.warn(`加载文件失败: ${path}`, error);
                    }
                }
            }

            parseMarkdown(content) {
                const frontMatter = {};
                let markdownContent = content;
                
                const frontMatterRegex = /^---\s*\n([\s\S]*?)\n---\s*\n([\s\S]*)$/;
                const match = content.match(frontMatterRegex);
                
                if (match) {
                    const frontMatterText = match[1];
                    markdownContent = match[2];
                    
                    const lines = frontMatterText.split('\n');
                    lines.forEach(line => {
                        const colonIndex = line.indexOf(':');
                        if (colonIndex > 0) {
                            const key = line.slice(0, colonIndex).trim();
                            const value = line.slice(colonIndex + 1).trim();
                            frontMatter[key] = value;
                        }
                    });
                }
                
                return { frontMatter, content: markdownContent };
            }

            getTypeIcon(type) {
                const icons = {
                    'web': 'fas fa-globe',
                    'software': 'fas fa-download',
                    'file': 'fas fa-file',
                    'article': 'fas fa-newspaper'
                };
                return icons[type] || 'fas fa-question-circle';
            }

            filterResources() {
                this.filteredResources = this.resources.filter(resource => {
                    const matchesSearch = !this.searchTerm || 
                        resource.title.toLowerCase().includes(this.searchTerm.toLowerCase()) ||
                        resource.description.toLowerCase().includes(this.searchTerm.toLowerCase()) ||
                        resource.tags.some(tag => tag.toLowerCase().includes(this.searchTerm.toLowerCase()));
                    
                    const matchesCategory = !this.currentCategory || resource.category === this.currentCategory;
                    const matchesType = !this.currentType || resource.type === this.currentType;
                    
                    return matchesSearch && matchesCategory && matchesType;
                });
                
                this.updateResourceCount();
                return this.filteredResources;
            }

            updateStats() {
                const webCount = this.resources.filter(r => r.type === 'web').length;
                const softwareCount = this.resources.filter(r => r.type === 'software').length;
                const fileCount = this.resources.filter(r => r.type === 'file').length;
                const articleCount = this.resources.filter(r => r.type === 'article').length;
                
                document.getElementById('webCount').textContent = webCount;
                document.getElementById('softwareCount').textContent = softwareCount;
                document.getElementById('fileCount').textContent = fileCount;
                document.getElementById('articleCount').textContent = articleCount;
            }

            renderCategories() {
                const container = document.getElementById('categoryFilters');
                if (!container) return;
                
                container.innerHTML = '';
                
                // 添加"全部"选项
                const allBtn = document.createElement('button');
                allBtn.className = `filter-btn ${!this.currentCategory ? 'active' : ''}`;
                allBtn.textContent = '全部';
                allBtn.onclick = () => this.setCategory('');
                container.appendChild(allBtn);
                
                // 添加各个分类
                Array.from(this.categories).sort().forEach(category => {
                    const btn = document.createElement('button');
                    btn.className = `filter-btn ${this.currentCategory === category ? 'active' : ''}`;
                    btn.textContent = category;
                    btn.onclick = () => this.setCategory(category);
                    container.appendChild(btn);
                });
            }

            renderTypes() {
                const container = document.getElementById('typeFilters');
                if (!container) return;
                
                container.innerHTML = '';
                
                // 添加"全部"选项
                const allBtn = document.createElement('button');
                allBtn.className = `filter-btn ${!this.currentType ? 'active' : ''}`;
                allBtn.textContent = '全部';
                allBtn.onclick = () => this.setType('');
                container.appendChild(allBtn);
                
                // 添加各个类型
                Array.from(this.types).forEach(type => {
                    const btn = document.createElement('button');
                    btn.className = `filter-btn ${this.currentType === type ? 'active' : ''}`;
                    btn.textContent = this.getTypeLabel(type);
                    btn.onclick = () => this.setType(type);
                    container.appendChild(btn);
                });
            }

            getTypeLabel(type) {
                const labels = {
                    'web': '网页',
                    'software': '软件',
                    'file': '文件',
                    'article': '文章'
                };
                return labels[type] || type;
            }

            renderResources() {
                const container = document.getElementById('resourcesGrid');
                if (!container) return;
                
                const resources = this.filteredResources;
                
                if (resources.length === 0) {
                    container.innerHTML = `
                        <div style="grid-column: 1 / -1; text-align: center; padding: 3rem; color: var(--text-secondary);">
                            <i class="fas fa-search" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                            <h3>未找到匹配的资源</h3>
                            <p>尝试使用不同的搜索词或筛选条件</p>
                        </div>
                    `;
                    return;
                }
                
                container.innerHTML = resources.map(resource => `
                    <div class="resource-card" data-id="${resource.id}">
                        <div class="resource-header">
                            <span class="resource-type">${this.getTypeLabel(resource.type)}</span>
                        </div>
                        <div class="resource-body">
                            <h3 class="resource-title">${resource.title}</h3>
                            <p class="resource-description">${resource.description || '暂无描述'}</p>
                            <div class="resource-meta">
                                <span><i class="fas fa-folder"></i> ${resource.category}</span>
                                <span><i class="fas fa-calendar"></i> ${resource.date}</span>
                            </div>
                            ${resource.tags.length > 0 ? `
                                <div style="margin-top: 0.75rem;">
                                    ${resource.tags.map(tag => `
                                        <span style="display: inline-block; padding: 0.125rem 0.5rem; background: var(--bg-secondary); color: var(--text-secondary); border-radius: 0.25rem; font-size: 0.75rem; margin-right: 0.25rem;">
                                            ${tag}
                                        </span>
                                    `).join('')}
                                </div>
                            ` : ''}
                        </div>
                        <div class="resource-footer">
                            <div>
                                <i class="fas ${resource.icon}" style="color: var(--primary);"></i>
                            </div>
                            <div class="resource-actions">
                                ${resource.url !== '#' ? `
                                    <a href="${resource.url}" target="_blank" class="action-btn">
                                        <i class="fas fa-external-link-alt"></i> 访问
                                    </a>
                                ` : ''}
                                <button class="action-btn view-details" data-id="${resource.id}">
                                    <i class="fas fa-info-circle"></i> 详情
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
                
                // 绑定详情按钮事件
                container.querySelectorAll('.view-details').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const resourceId = e.target.closest('.view-details').getAttribute('data-id');
                        const resource = this.resources.find(r => r.id === resourceId);
                        if (resource) {
                            this.showResourceDetails(resource);
                        }
                    });
                });
            }

            showResourceDetails(resource) {
                const modal = document.getElementById('resourceModal');
                const title = document.getElementById('modalTitle');
                const content = document.getElementById('modalContent');
                
                title.textContent = resource.title;
                
                let contentHtml = `
                    <div style="margin-bottom: 1.5rem; padding: 1rem; background: var(--bg-secondary); border-radius: 0.5rem;">
                        <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
                            <span style="padding: 0.25rem 0.75rem; background: var(--primary); color: white; border-radius: 9999px; font-size: 0.875rem;">
                                ${this.getTypeLabel(resource.type)}
                            </span>
                            <span style="padding: 0.25rem 0.75rem; background: var(--warning); color: white; border-radius: 9999px; font-size: 0.875rem;">
                                ${resource.category}
                            </span>
                        </div>
                        ${resource.url !== '#' ? `
                            <p><strong>链接：</strong> <a href="${resource.url}" target="_blank" style="color: var(--primary);">${resource.url}</a></p>
                        ` : ''}
                        ${resource.date ? `<p><strong>日期：</strong> ${resource.date}</p>` : ''}
                        ${resource.tags.length > 0 ? `
                            <p><strong>标签：</strong> 
                                ${resource.tags.map(tag => `<span style="display: inline-block; padding: 0.125rem 0.5rem; background: var(--bg-primary); color: var(--text-primary); border-radius: 0.25rem; font-size: 0.75rem; margin-right: 0.25rem;">${tag}</span>`).join('')}
                            </p>
                        ` : ''}
                    </div>
                `;
                
                if (resource.content && resource.content.trim()) {
                    if (window.marked) {
                        contentHtml += window.marked.parse(resource.content);
                    } else {
                        contentHtml += `<pre>${resource.content}</pre>`;
                    }
                } else {
                    contentHtml += `<p style="color: var(--text-secondary); text-align: center; padding: 2rem;">暂无详细内容</p>`;
                }
                
                content.innerHTML = contentHtml;
                modal.style.display = 'block';
            }

            setCategory(category) {
                this.currentCategory = category;
                this.filterResources();
                this.renderCategories();
                this.renderResources();
                this.updateFilterTitle();
            }

            setType(type) {
                this.currentType = type;
                this.filterResources();
                this.renderTypes();
                this.renderResources();
                this.updateFilterTitle();
            }

            setSearchTerm(term) {
                this.searchTerm = term;
                this.filterResources();
                this.renderResources();
            }

            updateFilterTitle() {
                const title = document.getElementById('currentFilter');
                if (!title) return;
                
                let filterText = '全部资源';
                if (this.currentCategory && !this.currentType) {
                    filterText = this.currentCategory;
                } else if (!this.currentCategory && this.currentType) {
                    filterText = this.getTypeLabel(this.currentType);
                } else if (this.currentCategory && this.currentType) {
                    filterText = `${this.currentCategory} - ${this.getTypeLabel(this.currentType)}`;
                }
                
                title.textContent = filterText;
            }

            updateResourceCount() {
                const countElement = document.getElementById('resourceCount');
                if (countElement) {
                    const total = this.resources.length;
                    const filtered = this.filteredResources.length;
                    countElement.textContent = filtered === total ? 
                        `共 ${total} 个资源` : 
                        `共 ${filtered} 个资源（已筛选）`;
                }
            }

            showLoading() {
                const loading = document.getElementById('loadingIndicator');
                const error = document.getElementById('errorMessage');
                const grid = document.getElementById('resourcesGrid');
                
                if (loading) loading.style.display = 'block';
                if (error) error.style.display = 'none';
                if (grid) grid.style.display = 'none';
            }

            hideLoading() {
                const loading = document.getElementById('loadingIndicator');
                const grid = document.getElementById('resourcesGrid');
                
                if (loading) loading.style.display = 'none';
                if (grid) grid.style.display = 'grid';
            }

            showError() {
                const loading = document.getElementById('loadingIndicator');
                const error = document.getElementById('errorMessage');
                const grid = document.getElementById('resourcesGrid');
                
                if (loading) loading.style.display = 'none';
                if (error) error.style.display = 'block';
                if (grid) grid.style.display = 'none';
            }
        }

        // 初始化应用
        document.addEventListener('DOMContentLoaded', () => {
            const resourceManager = new ResourceManager();
            
            // 加载资源
            resourceManager.loadResources();
            
            // 搜索功能
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('input', (e) => {
                    resourceManager.setSearchTerm(e.target.value);
                });
            }
            
            // 主题切换
            const themeToggle = document.getElementById('themeToggle');
            if (themeToggle) {
                themeToggle.addEventListener('click', () => {
                    document.body.classList.toggle('dark-mode');
                    const icon = themeToggle.querySelector('i');
                    const text = themeToggle.querySelector('span');
                    
                    if (document.body.classList.contains('dark-mode')) {
                        icon.className = 'fas fa-sun';
                        text.textContent = '浅色模式';
                        localStorage.setItem('theme', 'dark');
                    } else {
                        icon.className = 'fas fa-moon';
                        text.textContent = '深色模式';
                        localStorage.setItem('theme', 'light');
                    }
                });
                
                // 加载保存的主题
                const savedTheme = localStorage.getItem('theme');
                if (savedTheme === 'dark') {
                    document.body.classList.add('dark-mode');
                    themeToggle.querySelector('i').className = 'fas fa-sun';
                    themeToggle.querySelector('span').textContent = '浅色模式';
                }
            }
            
            // 模态框关闭
            const modal = document.getElementById('resourceModal');
            const modalClose = document.getElementById('modalClose');
            
            if (modalClose) {
                modalClose.addEventListener('click', () => {
                    modal.style.display = 'none';
                });
            }
            
            window.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.style.display = 'none';
                }
            });
        });
    </script>
</body>
</html>